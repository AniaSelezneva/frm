{"version":3,"sources":["utils/store.js","utils/faunaDB.js","utils/auth.js","HOCs/WithLoader.js","pages/Signup.js","components/User.js","pages/Home.js","pages/Login.js","App.js","serviceWorker.js","index.js"],"names":["initialState","loggedIn","user","email","handle","imageUrl","store","createContext","Provider","StateProvider","children","useReducer","state","action","type","payload","dispatch","value","q","faunadb","query","adminClient","Client","secret","process","auth","GoTrue","APIUrl","audience","setCookie","WithLoader","ComponentToWrap","loadingMessage","props","useState","isLoading","setIsLoading","useContext","setEmail","setHandle","password","setPassword","confirmPassword","setConfirmPassword","handleUnique","setHandleUnique","emailUnique","setEmailUnique","passwordsMatch","setPasswordsMatch","isError","setIsError","useEffect","currentUser","undefined","signup","e","a","preventDefault","Promise","resolve","reject","Exists","Match","Index","Casefold","Create","Collection","data","ret","login","console","log","onSubmit","method","htmlFor","name","id","onChange","target","required","getUserInfo","fetch","JSON","parse","Get","res","src","alt","to","posts","setPosts","getAllPosts","Map","Paginate","Lambda","Var","map","post","index","key","body","userHandle","error","setError","message","App","exact","path","component","Home","Signup","Login","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.00847d3e.chunk.js","sourcesContent":["import React, { createContext, useReducer } from \"react\";\r\n\r\nconst initialState = {\r\n  loggedIn: false,\r\n  user: { email: null, handle: null, imageUrl: null },\r\n};\r\n// store has Provider and Consumer components\r\nconst store = createContext(initialState);\r\nconst { Provider } = store;\r\n\r\nconst StateProvider = ({ children }) => {\r\n  const reducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n      case \"LOG_IN\":\r\n        return { ...state, loggedIn: true };\r\n      case \"FETCH_USER\": {\r\n        return { ...state, user: action.payload };\r\n      }\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  return <Provider value={{ state, dispatch }}>{children}</Provider>;\r\n};\r\n\r\nexport { store, StateProvider };\r\n\r\n// Provider sends state and dispatch to all the lower components.\r\n// Lower components will access it through useContext(store).\r\n// Store is created here.\r\n","import faunadb from \"faunadb\";\r\n\r\nexport const q = faunadb.query;\r\nexport const adminClient = new faunadb.Client({\r\n  secret: process.env.REACT_APP_SECRET,\r\n});\r\n","// GoTrue - user authentication library\r\nimport GoTrue from \"gotrue-js\";\r\n\r\n// GoTrue\r\nconst auth = new GoTrue({\r\n  APIUrl: \"https://forum-wtchs.netlify.app/.netlify/identity\",\r\n  audience: \"\",\r\n  setCookie: false,\r\n});\r\n\r\nexport default auth;\r\n","import React, { useState } from \"react\";\r\n\r\nfunction WithLoader(ComponentToWrap, loadingMessage) {\r\n  return function ComponentWithLoader(props) {\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    return (\r\n      <>\r\n        {isLoading && <h1>{loadingMessage}</h1>}\r\n        <ComponentToWrap {...props} setIsLoading={setIsLoading} />\r\n      </>\r\n    );\r\n  };\r\n}\r\n\r\nexport default WithLoader;\r\n","import React, { useState, useContext, useEffect } from \"react\";\r\n// store\r\nimport { store } from \"../utils/store\";\r\n// faunaDB\r\nimport { q, adminClient } from \"../utils/faunaDB\";\r\n// auth\r\nimport auth from \"../utils/auth\";\r\n// withLoader hoc\r\nimport WithLoader from \"../HOCs/WithLoader\";\r\n\r\nfunction Signup({ setIsLoading }) {\r\n  const { state, dispatch } = useContext(store);\r\n\r\n  const [email, setEmail] = useState();\r\n  const [handle, setHandle] = useState();\r\n  const [password, setPassword] = useState();\r\n  const [confirmPassword, setConfirmPassword] = useState();\r\n\r\n  const [handleUnique, setHandleUnique] = useState();\r\n  const [emailUnique, setEmailUnique] = useState();\r\n  const [passwordsMatch, setPasswordsMatch] = useState();\r\n\r\n  // General error\r\n  const [isError, setIsError] = useState();\r\n\r\n  // Check if user is signed in.\r\n  useEffect(() => {\r\n    // If he is...\r\n    if (auth.currentUser() !== null && auth.currentUser() !== undefined) {\r\n      // change loggedIn property in state object.\r\n      dispatch({ type: \"LOG_IN\" });\r\n    }\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  // Add user to 'users' collection in db.\r\n  const addUserToDb = () => {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        const ret = await adminClient.query(\r\n          q.Create(q.Collection(\"users\"), {\r\n            data: {\r\n              handle: handle,\r\n              email: email,\r\n              imageUrl: \"imageUrl1.com\",\r\n            },\r\n          })\r\n        );\r\n        resolve(ret);\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Check if user handle doesn't exist in db already.\r\n  const isHandleUnique = () => {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        const res = await adminClient.query(\r\n          q.Exists(q.Match(q.Index(\"users_by_handle\"), q.Casefold(handle)))\r\n        );\r\n\r\n        if (res === true) {\r\n          setHandleUnique(false);\r\n          resolve(false);\r\n        } else {\r\n          setHandleUnique(true);\r\n          resolve(true);\r\n        }\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Check if user email doesn't exist in db already.\r\n  const isEmailUnique = () => {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        const res = await adminClient.query(\r\n          q.Exists(q.Match(q.Index(\"users_by_email\"), q.Casefold(email)))\r\n        );\r\n\r\n        if (res === true) {\r\n          setEmailUnique(false);\r\n          resolve(false);\r\n        } else {\r\n          setEmailUnique(true);\r\n          resolve(true);\r\n        }\r\n      } catch (error) {\r\n        reject(error);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Check if password and confirmPassword match.\r\n  const doPasswordsMatch = () => {\r\n    if (password === confirmPassword) {\r\n      setPasswordsMatch(true);\r\n      return true;\r\n    } else {\r\n      setPasswordsMatch(false);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Signup and login at the same time.\r\n  const signup = async (e) => {\r\n    setIsLoading(true);\r\n    try {\r\n      e.preventDefault();\r\n      const handleUnique = await isHandleUnique();\r\n      const emailUnique = await isEmailUnique();\r\n\r\n      if (handleUnique && emailUnique && doPasswordsMatch()) {\r\n        await auth.signup(email, password);\r\n        await addUserToDb();\r\n        await auth.login(email, password, true);\r\n        dispatch({ type: \"LOG_IN\" });\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      setIsError(true);\r\n    }\r\n    setIsLoading(false);\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={(e) => {\r\n        signup(e);\r\n      }}\r\n      method=\"post\"\r\n    >\r\n      <label htmlFor=\"email\">Email:</label>\r\n      <input\r\n        type=\"email\"\r\n        name=\"email\"\r\n        id=\"email\"\r\n        onChange={(e) => {\r\n          setEmailUnique(undefined);\r\n          setIsError(false);\r\n          setEmail(e.target.value);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n\r\n      {emailUnique === false ? <p>This email is already in use</p> : null}\r\n\r\n      <label htmlFor=\"handle\">Username:</label>\r\n      <input\r\n        type=\"text\"\r\n        name=\"handle\"\r\n        id=\"handle\"\r\n        onChange={(e) => {\r\n          setHandleUnique(undefined);\r\n          setIsError(false);\r\n          setHandle(e.target.value);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n\r\n      {handleUnique === false ? <p>This handle is already in use</p> : null}\r\n\r\n      <label htmlFor=\"password\">Password:</label>\r\n      <input\r\n        type=\"password\"\r\n        name=\"password\"\r\n        id=\"password\"\r\n        onChange={(e) => {\r\n          setPassword(e.target.value);\r\n          setIsError(false);\r\n          setPasswordsMatch(true);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n\r\n      <label htmlFor=\"confirmPassword\">Confirm password:</label>\r\n      <input\r\n        type=\"password\"\r\n        name=\"confirmPassword\"\r\n        id=\"confirmPassword\"\r\n        onChange={(e) => {\r\n          setConfirmPassword(e.target.value);\r\n          setIsError(false);\r\n          setPasswordsMatch(true);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n      {passwordsMatch === false ? <p>Passwords don't match</p> : null}\r\n\r\n      {isError && <p>Error occured, please try again later</p>}\r\n\r\n      <button type=\"submit\">Signup</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default WithLoader(Signup, \"loading\");\r\n","import React, { useState, useContext, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n// store\r\nimport { store } from \"../utils/store\";\r\n// faunaDB\r\nimport { q, adminClient } from \"../utils/faunaDB\";\r\n// auth\r\nimport auth from \"../utils/auth\";\r\n// withLoader hoc\r\nimport WithLoader from \"../HOCs/WithLoader\";\r\n\r\nfunction User({ setIsLoading }) {\r\n  const { state, dispatch } = useContext(store);\r\n  const [email, setEmail] = useState();\r\n\r\n  const getUserInfo = async () => {\r\n    const data = await fetch(\"/.netlify/functions/avatar\");\r\n    const data1 = await JSON.parse(data);\r\n    console.log(data);\r\n\r\n    setIsLoading(true);\r\n    const res = await adminClient.query(\r\n      q.Get(q.Match(q.Index(\"users_by_email\"), q.Casefold(email)))\r\n    );\r\n    dispatch({ type: \"FETCH_USER\", payload: res.data });\r\n    setIsLoading(false);\r\n  };\r\n\r\n  // Check if user is signed in.\r\n  useEffect(() => {\r\n    // If he is...\r\n    if (auth.currentUser() !== null && auth.currentUser() !== undefined) {\r\n      // change loggedIn property in state object.\r\n      dispatch({ type: \"LOG_IN\" });\r\n      setEmail(auth.currentUser().email);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (email !== null && email !== undefined) {\r\n      getUserInfo();\r\n    }\r\n  }, [email]);\r\n\r\n  return (\r\n    <>\r\n      {state.loggedIn ? (\r\n        <div>\r\n          <p>{state.user.handle}</p>\r\n          <p>{state.user.email}</p>\r\n          <img src={state.user.imageUrl} alt=\"profile image\" />\r\n        </div>\r\n      ) : (\r\n        <div>\r\n          <Link to=\"/login\">Login</Link>\r\n          <Link to=\"/signup\">Signup</Link>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default WithLoader(User, \"wait...\");\r\n","import React, { useEffect, useState } from \"react\";\r\n// withLoader hoc\r\nimport WithLoader from \"../HOCs/WithLoader\";\r\n// faunaDB\r\nimport { q, adminClient } from \"../utils/faunaDB\";\r\n// Components\r\nimport User from \"../components/User\";\r\n\r\nfunction Home({ setIsLoading }) {\r\n  const [posts, setPosts] = useState([]);\r\n\r\n  // Fetch all posts.\r\n  const getAllPosts = async () => {\r\n    const res = await adminClient.query(\r\n      q.Map(\r\n        q.Paginate(q.Match(q.Index(\"all_posts\"))),\r\n        q.Lambda(\"X\", q.Get(q.Var(\"X\")))\r\n      )\r\n    );\r\n\r\n    setPosts(res.data);\r\n    setIsLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    getAllPosts();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      {posts.map((post, index) => (\r\n        <div key={index}>\r\n          <p>{post.data.body}</p>\r\n          <h6>{post.data.userHandle}</h6>\r\n        </div>\r\n      ))}\r\n      <User />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default WithLoader(Home, \"wait...\");\r\n","import React, { useState, useContext, useEffect } from \"react\";\r\n// store\r\nimport { store } from \"../utils/store\";\r\n// auth\r\nimport auth from \"../utils/auth\";\r\n// withLoader hoc\r\nimport WithLoader from \"../HOCs/WithLoader\";\r\n\r\nfunction Login({ setIsLoading }) {\r\n  const { state, dispatch } = useContext(store);\r\n\r\n  const [email, setEmail] = useState();\r\n  const [password, setPassword] = useState();\r\n  const [error, setError] = useState(undefined);\r\n\r\n  // Check if user is signed in.\r\n  useEffect(() => {\r\n    // If he is...\r\n    if (auth.currentUser() !== null && auth.currentUser() !== undefined) {\r\n      // change loggedIn property in state object.\r\n      dispatch({ type: \"LOG_IN\" });\r\n    }\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  // Login\r\n  const login = async (e) => {\r\n    setIsLoading(true);\r\n    e.preventDefault();\r\n    try {\r\n      await auth.login(email, password, true);\r\n      dispatch({ type: \"LOG_IN\" });\r\n    } catch (error) {\r\n      if (error.message == \"invalid_grant: Email not confirmed\") {\r\n        setError(\"Email not confirmed\");\r\n      } else if (\r\n        error.message ==\r\n        \"invalid_grant: No user found with that email, or password invalid.\"\r\n      ) {\r\n        setError(\"No user found with that email, or password invalid\");\r\n      } else {\r\n        setError(\"Error occured, please try again later\");\r\n      }\r\n    }\r\n    setIsLoading(false);\r\n  };\r\n\r\n  return (\r\n    <form\r\n      onSubmit={(e) => {\r\n        login(e);\r\n      }}\r\n      method=\"post\"\r\n    >\r\n      <label htmlFor=\"email\">Email:</label>\r\n      <input\r\n        type=\"email\"\r\n        name=\"email\"\r\n        id=\"email\"\r\n        onChange={(e) => {\r\n          setEmail(e.target.value);\r\n          setError(undefined);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n\r\n      <label htmlFor=\"password\">Password:</label>\r\n      <input\r\n        type=\"password\"\r\n        name=\"password\"\r\n        id=\"password\"\r\n        onChange={(e) => {\r\n          setPassword(e.target.value);\r\n          setError(undefined);\r\n        }}\r\n        required=\"required\"\r\n      ></input>\r\n\r\n      {error !== undefined && <p>{error}</p>}\r\n\r\n      <button type=\"submit\">Login</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default WithLoader(Login, \"wait\");\r\n","import React, { useContext } from \"react\";\nimport \"./App.css\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\n// Components\nimport Signup from \"./pages/Signup\";\nimport Home from \"./pages/Home\";\nimport Login from \"./pages/Login\";\n// Store\nimport { store } from \"./utils/store\";\n\nfunction App() {\n  const { state, dispatch } = useContext(store);\n\n  return (\n    <Router>\n      <Switch>\n        <Route exact path=\"/\" component={Home} />\n        <Route path=\"/signup\" component={Signup}>\n          {state.loggedIn && <Redirect to=\"/\" />}\n        </Route>\n        <Route path=\"/login\" component={Login}>\n          {state.loggedIn && <Redirect to=\"/\" />}\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\n// State provider\nimport { StateProvider } from \"./utils/store\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <StateProvider>\n      <App />\n    </StateProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}