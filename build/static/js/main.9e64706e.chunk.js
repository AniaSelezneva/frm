(this.webpackJsonpforum=this.webpackJsonpforum||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(51),o=n.n(c),u=(n(59),n(60),n(52)),i=n(1),s=n(7),l=n.n(s),m=n(11),d=n(3),p=n(31),f={loggedIn:!1,user:null},h=Object(a.createContext)(f),b=h.Provider,v=function(e){var t=e.children,n=Object(a.useReducer)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOG_IN":return Object(p.a)(Object(p.a)({},e),{},{loggedIn:!0});default:return e}}),f),c=Object(d.a)(n,2),o=c[0],u=c[1];return r.a.createElement(b,{value:{state:o,dispatch:u}},t)},w=n(28),E=n.n(w),g=n(21),O=n.n(g),j=new O.a({APIUrl:"https://forum-wtchs.netlify.app/.netlify/identity",audience:"",setCookie:!1}),y=E.a.query,x=new E.a.Client({secret:"fnAD1yQ6nyACATcGUq8PXJ39ZoIVPdQIngRkw6j6"});var C=function(){var e=Object(a.useContext)(h),t=(e.state,e.dispatch),n=Object(a.useState)(),c=Object(d.a)(n,2),o=c[0],u=c[1],i=Object(a.useState)(),s=Object(d.a)(i,2),p=s[0],f=s[1],b=Object(a.useState)(),v=Object(d.a)(b,2),w=v[0],E=v[1],g=Object(a.useState)(),O=Object(d.a)(g,2),C=O[0],k=O[1],q=Object(a.useState)(),S=Object(d.a)(q,2),I=S[0],P=S[1],U=Object(a.useState)(),_=Object(d.a)(U,2),F=_[0],N=_[1],A=Object(a.useState)(),G=Object(d.a)(A,2),L=G[0],D=G[1],J=Object(a.useState)(),M=Object(d.a)(J,2),T=M[0],B=M[1];Object(a.useEffect)((function(){null!==j.currentUser()&&void 0!==j.currentUser()&&t({type:"LOG_IN"})}),[]);var Q=function(){var e=Object(m.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),e.next=4,new Promise(function(){var e=Object(m.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.query(y.Exists(y.Match(y.Index("users_by_handle"),y.Casefold(p))));case 3:!0===e.sent?(P(!1),t(!1)):(P(!0),t(!0)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 4:return n=e.sent,e.next=7,new Promise(function(){var e=Object(m.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.query(y.Exists(y.Match(y.Index("users_by_email"),y.Casefold(o))));case 3:!0===e.sent?(N(!1),t(!1)):(N(!0),t(!0)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 7:if(a=e.sent,!(n&&a&&(w===C?(D(!0),1):(D(!1),0)))){e.next=13;break}return e.next=11,j.signup(o,w);case 11:return e.next=13,new Promise(function(){var e=Object(m.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.query(y.Create(y.Collection("users"),{data:{handle:p,email:o,imageUrl:"imageUrl1.com"}}));case 3:a=e.sent,t(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0),B(!0);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:function(e){Q(e)},method:"post"},r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",{type:"email",name:"email",id:"email",onChange:function(e){N(void 0),B(!1),u(e.target.value)},required:"required"}),!1===F?r.a.createElement("p",null,"This email is already in use"):null,r.a.createElement("label",{htmlFor:"handle"},"Username:"),r.a.createElement("input",{type:"text",name:"handle",id:"handle",onChange:function(e){P(void 0),B(!1),f(e.target.value)},required:"required"}),!1===I?r.a.createElement("p",null,"This handle is already in use"):null,r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",name:"password",id:"password",onChange:function(e){E(e.target.value),B(!1),D(!0)},required:"required"}),r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm password:"),r.a.createElement("input",{type:"password",name:"confirmPassword",id:"confirmPassword",onChange:function(e){k(e.target.value),B(!1),D(!0)},required:"required"}),!1===L?r.a.createElement("p",null,"Passwords don't match"):null,T&&r.a.createElement("p",null,"Error occured, please try again later"),r.a.createElement("button",{type:"submit"},"Signup"))},k=new O.a({APIUrl:"https://forum-wtchs.netlify.app/.netlify/identity",audience:"",setCookie:!1});var q=function(){return Object(a.useEffect)((function(){console.log(k.currentUser())}),[]),r.a.createElement("div",null,"Home")};var S=function(){var e=Object(a.useContext)(h),t=(e.state,e.dispatch),n=Object(a.useState)(),c=Object(d.a)(n,2),o=c[0],u=c[1],i=Object(a.useState)(),s=Object(d.a)(i,2),p=s[0],f=s[1],b=Object(a.useState)(void 0),v=Object(d.a)(b,2),w=v[0],E=v[1];Object(a.useEffect)((function(){null!==j.currentUser()&&void 0!==j.currentUser()&&t({type:"LOG_IN"})}),[]);var g=function(){var e=Object(m.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,j.login(o,p,!0);case 4:t({type:"LOG_IN"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),"invalid_grant: Email not confirmed"==e.t0.message?E("Email not confirmed"):"invalid_grant: No user found with that email, or password invalid."==e.t0.message?E("No user found with that email, or password invalid"):E("Error occured, please try again later");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:function(e){g(e)},method:"post"},r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",{type:"email",name:"email",id:"email",onChange:function(e){u(e.target.value),E(void 0)},required:"required"}),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",name:"password",id:"password",onChange:function(e){f(e.target.value),E(void 0)},required:"required"}),void 0!==w&&r.a.createElement("p",null,w),r.a.createElement("button",{type:"submit"},"Signup"))};var I=function(){var e=Object(a.useContext)(h),t=e.state;return e.dispatch,r.a.createElement(u.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:q}),r.a.createElement(i.b,{path:"/signup",component:C},t.loggedIn&&r.a.createElement(i.a,{to:"/"})),r.a.createElement(i.b,{path:"/login",component:S})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null,r.a.createElement(I,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},54:function(e,t,n){e.exports=n(105)},59:function(e,t,n){},60:function(e,t,n){},81:function(e,t){},83:function(e,t){}},[[54,1,2]]]);
//# sourceMappingURL=main.9e64706e.chunk.js.map